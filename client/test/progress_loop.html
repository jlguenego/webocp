<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Web OCP</title>
		<script src="../_ext/jquery-1.10.2.min.js"></script>
		<script src="../_ext/jquery-ui-1.10.3/ui/minified/jquery-ui.min.js"></script>
		<link rel="stylesheet" href="../_ext/jquery-ui-1.10.3/themes/base/minified/jquery-ui.min.css" />

		<!-- PROGRESSBAR -->
		<script src="../js/ocp/widget_progressbar.js"></script>
		<link rel="stylesheet" href="../js/ocp/theme/default/widget_progressbar.css" />
		<!-- END PROGRESSBAR -->

		<script src="../js/ocp.js"></script>
		<script src="../js/ocp_profile.js"></script>
		<script src="../js/ocp_progress.js"></script>
		<script src="upload_crypt_file.js"></script>

		<style>
html, body {
	margin: 0px;
	padding: 0px;
	height: 100%;
}
		</style>
	</head>

	<body>
		<button>Start</button>
		<div id="progress" style="position: relative; width: 200px; height: 50px;"></div>

		<script>
			$('#progress').ocp_progressbar();

			$('button').click(function() {
				$('#progress').ocp_progressbar('set_progress', 0);
				var progress = new ocp.progress(function(percent) {
					$('#progress').ocp_progressbar('set_progress', percent);
				});

				var total = 300;
				function iteration(i) {
					//(function(i) {
						setTimeout(function() {
							sleep(10);
							progress.update(i, total);
						}, 5*i);
					//})(i);
				};

				for (var i = 0; i <= total; i++) {
					(function(i) {
						setTimeout(function() {
							sleep(10);
							progress.update(i, total);
						}, 5*i);
					})(i);
				}
			});

			function sleep(milliSeconds) {
				var startTime = new Date().getTime();
				while (new Date().getTime() < startTime + milliSeconds);
			}
		</script>
	</body>
</html>
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Web OCP</title>

		 <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans">

		<!-- JQUERY / JQUERY UI -->
		<script src="../_ext/jquery-1.10.2.min.js"></script>
		<script src="../_ext/jquery-ui-1.10.3/ui/minified/jquery-ui.min.js"></script>
		<link rel="stylesheet" href="../_ext/jquery-ui-1.10.3/themes/base/minified/jquery-ui.min.css" />
		<!-- END JQUERY / JQUERY UI -->

		<!-- OCP -->
		<script src="../js/ocp/core.js"></script>

			<!-- SPLITPANE -->
			<script src="../js/ocp/widget_splitpane_h.js"></script>
			<link rel="stylesheet" href="../js/ocp/theme/default/widget_splitpane_h.css" />
			<script src="../js/ocp/widget_splitpane_v.js"></script>
			<link rel="stylesheet" href="../js/ocp/theme/default/widget_splitpane_v.css" />
			<!-- END SPLITPANE -->

			<!-- TREE -->
			<script src="../js/ocp/widget_tree.js"></script>
			<link rel="stylesheet" href="../js/ocp/theme/default/widget_tree.css" />
			<!-- END TREE -->

			<!-- GRID -->
			<script src="../js/ocp/widget_grid.js"></script>
			<link rel="stylesheet" href="../js/ocp/theme/default/widget_grid.css" />
			<!-- END GRID -->
		<script src="../js/ocp/widget_header_content.js"></script>
		<!-- END OCP -->

		<style>
html, body {
	margin: 0px;
	padding: 0px;
	height: 100%;
	font-family: 'Open sans', serif;
	font-size: 13px;
}

#page {
	width: 100%;
	height: 100%;
}

#page_header {
	width: 100%;
	height: 50px;

	background-color: #151412;
}

#sidebar {
	background-color: #F2F2F3;
}

#sidebar_header {
	font-size: 14px;
	background-color: #D11E00;
	border: 0px;
	color: #FFFFFF;
	background-image: url(image/cloud2.png);
	background-size: 30px 30px;
	background-position: 14px center;
	padding: 15px 15px 16px 57px;
	background-repeat: no-repeat;
	box-sizing: border-box;
	height: 50px;
}

#sidebar_header img {
	position: relative;
	top: 10px;
	margin-left: 3px;
	margin-right: 10px;
	width: 29px;
	height: 27px;
}

#tree {
	padding-top: 5px;
	padding-left: 5px;
	overflow: auto;
	box-sizing: border-box;
}

#content {
	position: relative;
	background-color: #FFFFFF;
}

#content_header {
	background-color: #FFFFFF;
	border: 0;
	padding: 10px;
	box-sizing: border-box;
	height: 50px;
}

#content_menu {
	padding: 0px;
	margin: 0px;
	height: 100%
}

#content_menu li {
	position: relative;
	display: inline-block;
	padding: 5px 8px 5px 40px;
	margin: 0px 1px;
	box-sizing: border-box;
	height: 100%;
	background-color: #DADEE1;
	cursor: pointer;
}

#content_menu li:first-child {
	border-radius: 5px 0px 0px 5px;
}

#content_menu li:last-child {
	border-radius: 0px 5px 5px 0px;
}

#content_menu li img {
	position: absolute;
	top: 3px;
	left: 5px;
	width: 33px;
	height: 23px;
}

#grid {
	width: 100%;
}

#footer {
	background-color: red;
}

#footer_header {
	background-color: #FFFFFF;
	height: 17px;
	padding: 3px 5px 3px 35px;

	border: 0;
	background-image: url(image/transfers2.png);
	background-size: 40px 100px;
	background-position: 11px 6px;
	background-repeat: no-repeat;
}

#file_transfer {
	background-color: #FFFFFF;
}

#toggle_footer {
	float: right;
	margin-right: 10px;
	width: 15px;
	height: 15px;
	cursor: pointer;

	background-image: url('https://eu.static.mega.co.nz/images/mega/transfer-arrows.png');
	background-size: 30px 30px;
	background-position: 0% 0%;
}

#toggle_footer:hover {
	background-position: 100% 0%;
}

#toggle_footer.footer_maximize {
	background-position: 0% 100%;
}

#toggle_footer.footer_maximize:hover {
	background-position: 100% 100%;
}
		</style>
	</head>

	<body>
		<div id="page">
			<div id="page_header">
			</div>
			<div id="page_content">
				<div id="main">
					<div id="sidebar">
						<div id="sidebar_header">
							File manager
						</div>
						<div class="tree" id="tree"></div>
					</div>
					<div id="content">
						<div id="content_header">
							<ul id="content_menu">
								<li><img src="image/newfolder.png"/>Create folder</li>
								<li><img src="image/up.png"/>Upload file</li>
								<li><img src="image/folder-up.png"/>Upload folder</li>
							</ul>
						</div>
						<div id="grid"></div>
					</div>
				</div>
				<!--
				<div id="footer">
					<div id="footer_header">
						<div id="toggle_footer"></div>
						File transfers
					</div>
					<div id="file_transfer"></div>
				</div>
				-->
			</div>

		</div>
		<script>
			$('#page').ocp_header_content();
			$('#page_content').ocp_splitpane_v({
				overflow: 'hidden',
				size: { top: null, bottom: 150 },
				fixed: 'bottom'
			});

			// Set splitpane to the middle row
			$("#main").ocp_splitpane_h({
				source: [
					{ width: 400, }
				],
				overflow: 'hidden'
			});


			$('#sidebar').ocp_header_content();
			$('#content').ocp_header_content();
			$('#footer').ocp_header_content();

			var footer_restore_height = 150;
			$('#toggle_footer').click(function() {
				var new_height = 0;
				if ($(this).hasClass('footer_maximize')) { //Maximize
					new_height = footer_restore_height;
					$(this).removeClass('footer_maximize');
				} else { // Minimize
					footer_restore_height = $('#footer').outerHeight()
					new_height = $('#footer_header').outerHeight();
					$(this).addClass('footer_maximize');
				}
				var size = { bottom: new_height };
				$('#page_content').ocp_splitpane_v('resize', size);
			});

			// Put a tree on the left pane
			var src = [
				{
					name: '',
					label: 'Root',
					image: 'image/clouddrive.png',
					type: 'dir',
					expanded: true,
					children: []
				}
			];
			var tree = $('#tree').ocp_tree({
				source: src,
				ls: function(path) {
					var result = null;
					var dir_result = null;
					$.ajaxSetup({scriptCharset: "utf-8"});
					$.ajax({
  						type: "GET",
						url: 'http://localhost/webocp/server/endpoint/',
						async: false,
						data: {
							path: path
						},
						success: function(data) {
							result = $.parseJSON(data);
							dir_result = filter_dir(result);
							console.log('result=' + result);
							console.log('dir_result=' + dir_result);
						}
					});
					return dir_result;
				}
			});

			function filter_dir(array) {
				array = array.slice();
				for (var i = 0; i < array.length; i++) {
					if (array[i].type != 'dir')	{
						console.log('type=' + array[i].type);
						array.splice(i, 1);
						i--;
					}
				}
				console.log(array);
				return array;
			}

			function get_tree_source() {
				return tree.widget('options', 'source');
			}

			// Put a grid on right pane

			$("#grid").ocp_grid({
				column: {
					filename: {
						label: 'File name',
						width: 200
					},
					size: {
						label: 'Size',
						width: 70
					},
					last_modified: {
						label: 'Last modified',
						width: 100
					}
				},
				data: [
					{
						filename: 'kiki.txt1',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt2',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					}
				]
			});

			$("#file_transfer").ocp_grid({
				column: {
					filename: {
						label: 'File name',
						width: 200
					},
					size: {
						label: 'Size',
						width: 70
					},
					last_modified: {
						label: 'Last modified',
						width: 100
					}
				},
				data: [
					{
						filename: 'kiki.txt1',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt2',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					},
					{
						filename: 'keke.txt',
						size: '3Kb',
						last_modified: '2012/02/03'
					}
				]
			});
		</script>
	</body>
</html>